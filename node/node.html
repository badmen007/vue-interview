<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>浏览器渲染原理和性能优化 | 成长之路</title>
    <meta name="generator" content="VuePress 1.8.3">
    
    <meta name="description" content="无所畏惧,默默前行">
    
    <link rel="preload" href="/vue-interview/assets/css/0.styles.cffd48ad.css" as="style"><link rel="preload" href="/vue-interview/assets/js/app.b2d42ce3.js" as="script"><link rel="preload" href="/vue-interview/assets/js/2.7e7d8ebc.js" as="script"><link rel="preload" href="/vue-interview/assets/js/15.daff4719.js" as="script"><link rel="prefetch" href="/vue-interview/assets/js/10.12bc45ff.js"><link rel="prefetch" href="/vue-interview/assets/js/11.f1b5507b.js"><link rel="prefetch" href="/vue-interview/assets/js/12.12f8a401.js"><link rel="prefetch" href="/vue-interview/assets/js/13.2721b906.js"><link rel="prefetch" href="/vue-interview/assets/js/14.6cb811ef.js"><link rel="prefetch" href="/vue-interview/assets/js/16.81c95a0e.js"><link rel="prefetch" href="/vue-interview/assets/js/3.ce7584eb.js"><link rel="prefetch" href="/vue-interview/assets/js/4.0a13fbc8.js"><link rel="prefetch" href="/vue-interview/assets/js/5.686a82d5.js"><link rel="prefetch" href="/vue-interview/assets/js/6.3f4ffd09.js"><link rel="prefetch" href="/vue-interview/assets/js/7.82700557.js"><link rel="prefetch" href="/vue-interview/assets/js/8.82c3a0c6.js"><link rel="prefetch" href="/vue-interview/assets/js/9.7e9d8ee0.js">
    <link rel="stylesheet" href="/vue-interview/assets/css/0.styles.cffd48ad.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vue-interview/" class="home-link router-link-active"><!----> <span class="site-name">成长之路</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vue-interview/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-interview/node/node.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  node
</a></li><li class="dropdown-item"><!----> <a href="/vue-interview/js/js.html" class="nav-link">
  js
</a></li><li class="dropdown-item"><!----> <a href="/vue-interview/learnCss/css.html" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/vue-interview/mobx/mobx.html" class="nav-link">
  mobx
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><span class="title">面试</span> <span class="arrow down"></span></button> <button type="button" aria-label="面试" class="mobile-dropdown-title"><span class="title">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-interview/interview/interview.html" class="nav-link">
  面试
</a></li><li class="dropdown-item"><!----> <a href="/vue-interview/interview/vue.html" class="nav-link">
  vue面试题
</a></li><li class="dropdown-item"><!----> <a href="/vue-interview/interview/react.html" class="nav-link">
  react面试题
</a></li><li class="dropdown-item"><!----> <a href="/vue-interview/interview/js.html" class="nav-link">
  js面试题
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/badmen007" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://juejin.cn/user/3966693686127096" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vue-interview/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-interview/node/node.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  node
</a></li><li class="dropdown-item"><!----> <a href="/vue-interview/js/js.html" class="nav-link">
  js
</a></li><li class="dropdown-item"><!----> <a href="/vue-interview/learnCss/css.html" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/vue-interview/mobx/mobx.html" class="nav-link">
  mobx
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><span class="title">面试</span> <span class="arrow down"></span></button> <button type="button" aria-label="面试" class="mobile-dropdown-title"><span class="title">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-interview/interview/interview.html" class="nav-link">
  面试
</a></li><li class="dropdown-item"><!----> <a href="/vue-interview/interview/vue.html" class="nav-link">
  vue面试题
</a></li><li class="dropdown-item"><!----> <a href="/vue-interview/interview/react.html" class="nav-link">
  react面试题
</a></li><li class="dropdown-item"><!----> <a href="/vue-interview/interview/js.html" class="nav-link">
  js面试题
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/badmen007" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://juejin.cn/user/3966693686127096" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>浏览器渲染原理和性能优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue-interview/node/node.html#进程与线程" class="sidebar-link">进程与线程</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vue-interview/node/node.html#从输入url到浏览器渲染的过程" class="sidebar-link">从输入URL到浏览器渲染的过程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-interview/node/node.html#浏览器进程之间的相互调用" class="sidebar-link">浏览器进程之间的相互调用</a></li><li class="sidebar-sub-header"><a href="/vue-interview/node/node.html#url请求过程" class="sidebar-link">url请求过程</a></li><li class="sidebar-sub-header"><a href="/vue-interview/node/node.html#http的发展历程" class="sidebar-link">http的发展历程</a></li><li class="sidebar-sub-header"><a href="/vue-interview/node/node.html#渲染流程" class="sidebar-link">渲染流程</a></li></ul></li><li><a href="/vue-interview/node/node.html#网络的优化策略" class="sidebar-link">网络的优化策略</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vue-interview/node/node.html#渲染优化" class="sidebar-link">渲染优化</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vue-interview/node/node.html#静态文件优化" class="sidebar-link">静态文件优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-interview/node/node.html#图片优化" class="sidebar-link">图片优化</a></li><li class="sidebar-sub-header"><a href="/vue-interview/node/node.html#html优化" class="sidebar-link">html优化</a></li><li class="sidebar-sub-header"><a href="/vue-interview/node/node.html#css优化" class="sidebar-link">css优化</a></li><li class="sidebar-sub-header"><a href="/vue-interview/node/node.html#js优化" class="sidebar-link">JS优化</a></li><li class="sidebar-sub-header"><a href="/vue-interview/node/node.html#优化策略" class="sidebar-link">优化策略</a></li><li class="sidebar-sub-header"><a href="/vue-interview/node/node.html#浏览器的存储" class="sidebar-link">浏览器的存储</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="浏览器渲染原理和性能优化"><a href="#浏览器渲染原理和性能优化" class="header-anchor">#</a> 浏览器渲染原理和性能优化</h1> <h2 id="进程与线程"><a href="#进程与线程" class="header-anchor">#</a> 进程与线程</h2> <ul><li>进程是操作系统资源分配的基本单位，进程中包含线程</li> <li>线程是由进程管理的。为了提升浏览器的稳定性和安全性，浏览器采用了多进程的模型</li></ul> <p>浏览器的进程:</p> <ul><li>浏览器进程：负责界面的显示，用户交互，调度其它进程</li> <li>渲染进程：每个页卡都有单独的渲染进程，核心用于渲染进程</li> <li>网络进程：主要处理网路资源加载(html,css,js)</li> <li>GPU进程：3d绘制 提高性能</li> <li>插件进程：插件</li></ul> <h2 id="从输入url到浏览器渲染的过程"><a href="#从输入url到浏览器渲染的过程" class="header-anchor">#</a> 从输入URL到浏览器渲染的过程</h2> <h3 id="浏览器进程之间的相互调用"><a href="#浏览器进程之间的相互调用" class="header-anchor">#</a> 浏览器进程之间的相互调用</h3> <ul><li><p>用户输入url地址(会将关键字 会将关键字根据默认的引擎生成地址) 会开始导航</p></li> <li><p>浏览器进程 会准备一个渲染进程用于渲染页面</p></li> <li><p>网络进程加载资源，最终将加载的资源交给渲染进程</p></li> <li><p>渲染完毕显示 ipc</p></li> <li><p>七层网络模型 物理层 数据层 网络层 传输层(tcp 安全可靠 分段传输 udp 丢包的情况) (会话层 表示层 应用层)</p></li></ul> <h3 id="url请求过程"><a href="#url请求过程" class="header-anchor">#</a> url请求过程</h3> <ul><li>先去查找缓存, 检测缓存是否过期，如果没有过期直接返回缓存的数据</li> <li>看域名是否被解析过, DNS协议 将域名解析成ip地址(DNS 基于UDP) ip + 端口号</li> <li>请求是HTTPS  SSL协商</li> <li>ip地址来进行寻址，排队等待，最多能发送6个http请求</li> <li>tcp 创建链接用于传输 (三次握手)</li> <li>利用tcp传输数据 (拆分成数据包) 特点是 有序 可靠, 服务器会按照顺序来接收</li> <li>http请求 (请求行 请求头 请求体)</li> <li>默认不会断开(keep-alive) 为了下次传输数据时 可以复用上次创建的连接</li> <li>服务器收到数据后(响应行 响应头 响应体)</li> <li>服务器 返回301 302 会进行重定向操作</li> <li>服务器 304 回去查询浏览器缓存进行返回</li></ul> <blockquote><p>浏览器接收完成资源之后怎么处理？</p></blockquote> <h3 id="http的发展历程"><a href="#http的发展历程" class="header-anchor">#</a> http的发展历程</h3> <p>http 0.9 负责传输html 最早的时候没有请求头 和 响应头
http1.0 提供了 http的header 根据header的不同来处理不同的资源
http1.1 默认开启了keep-alive 链路复用(不用再重新连接) 管线化(同时建立多个连接) 服务器处理多个请求(队头阻塞问题)
http2.0 同一个tcp链接来发送数据 一个域名 一个tcp (多路复用) 头部压缩 服务器可以推送数据给客户端
http3.0 解决了tcp 的队头阻塞问题 QUIC协议 采用了udp</p> <h3 id="渲染流程"><a href="#渲染流程" class="header-anchor">#</a> 渲染流程</h3> <blockquote><p>样式不会阻塞html解析  html 渲染时 会先扫描css和js 便解析边绘制
js 会阻塞dom的解析 需要暂停dom解析去执行javascript, js可能会操作样式，所以需要等待样式加载完成,再继续加载
performance 去看就可以了
为什么css放在上面,  js放在下面</p></blockquote> <ul><li>渲染进程将HTML转变成DOM属性结构</li> <li>渲染进程把css文本转变成浏览器中的<code>stylesheet</code></li> <li>通过stylesheet计算出DOM节点的样式</li> <li>根据DOM树创建布局树</li> <li>通过布局树进行分层生产出图层树</li> <li>将不同的图层进行绘制,转交给合成线程处理, 最终生产页面, 并显示到浏览器上</li></ul> <h2 id="网络的优化策略"><a href="#网络的优化策略" class="header-anchor">#</a> 网络的优化策略</h2> <ul><li>减少HTTP请求数,因为请求多了 就会造成很多的TCP链接 重定向等等</li> <li>避免重定向, 重定向会影响响应的速度</li> <li>使用<code>dns-prefetch</code>,进行DNS解析, why</li> <li>采用域名分片技术，将资源放到不同的域名下。接触同一个域名最多处理6个TCP链接问题</li> <li>采用<code>cdn</code>加速加快了访问的速度</li> <li>gzip压缩优化 对传输资源进行体积压缩(html, js, css)</li> <li>加载数据优先级: <code>preload</code>(预先请求当前页面需要的资源) <code>prefetch</code> (将来页面中使用的资源) 将数据缓存到HTTP中</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>link ref<span class="token operator">=</span><span class="token string">'preload'</span> href<span class="token operator">=</span><span class="token string">'style.css'</span> <span class="token keyword">as</span><span class="token operator">=</span><span class="token string">'style'</span><span class="token operator">&gt;</span>
</code></pre></div><h2 id="渲染优化"><a href="#渲染优化" class="header-anchor">#</a> 渲染优化</h2> <ul><li>重排和重绘</li> <li>强制同步布局问题</li> <li>布局抖动问题</li> <li>渲染时给图片增加固定宽高</li> <li>尽量使用<code>css3</code>动画</li></ul> <h2 id="静态文件优化"><a href="#静态文件优化" class="header-anchor">#</a> 静态文件优化</h2> <h3 id="图片优化"><a href="#图片优化" class="header-anchor">#</a> 图片优化</h3> <ul><li>避免空的<code>src</code>的图片</li> <li>减少图片的尺寸，节约用户的流量</li> <li><code>img</code>标签设置<code>alt</code>属性，替身图片的加载失败时的用户体验</li> <li>原生的<code>loading:lazy</code> 图片懒加载</li> <li>不同环境下记载不同尺寸和像素图片</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./images/1.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">sizes</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(max-width:500px) 100px,(max-width:600px) 200px<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./images/1.jpg 100w, ./images/3.jpg 200w<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>对于较大的图片可以采用渐进式图片</li> <li>采用<code>Base64URL</code>减少图片的请求</li> <li>采用雪碧图合并图标图片等</li></ul> <h3 id="html优化"><a href="#html优化" class="header-anchor">#</a> <code>html</code>优化</h3> <ul><li>语义化<code>HTML</code>: 代码简洁清晰，有利于搜索引擎,便于团队的开发</li> <li>提前声明字符编码, 让浏览器快速确定如何渲染网页的内容</li> <li>减少HTML嵌套关系、减少DOM节点的数量</li> <li>删除多余空格、空行、注释、及无用的属性等</li> <li>避免使用table布局 为什么</li></ul> <h3 id="css优化"><a href="#css优化" class="header-anchor">#</a> <code>css</code>优化</h3> <ul><li>减少伪类选择器、减少样式的层数、减少使用通配符</li> <li>避免使用<code>css</code>表达式，<code>css</code>表达式会频繁的求值，当页面滚动，鼠标移动都会重新计算</li> <li>删除空行、注释、减少无意义的单位、<code>css</code>进行压缩</li> <li>使用外链<code>css</code>,可以对<code>css</code>进行缓存</li> <li>添加媒体字段，只加载有效的<code>css</code>文件</li> <li><code>css contain</code> 属性,将元素进行隔离</li> <li>减少使用@import, 由于@import是链式加载的</li></ul> <h3 id="js优化"><a href="#js优化" class="header-anchor">#</a> <code>JS</code>优化</h3> <ul><li>通过async defer异步加载文件</li> <li>减少DOM操作, 缓存访问过的元素</li> <li>操作不直接应用到DOM上, 而应用到虚拟DOM上。最有一次性应用到DOM上</li> <li>使用<code>webworker</code>解决程序阻塞问题</li> <li><code>Intersectionobserver</code></li> <li>虚拟滚动</li></ul> <h3 id="优化策略"><a href="#优化策略" class="header-anchor">#</a> 优化策略</h3> <ul><li>关键资源个数越多，首次页面加载的时间就越长</li> <li>关键资源的大小，内容越小，下载时间越短</li> <li>优化白屏： 内联<code>css</code>和内联<code>js</code>移除文件下载，较小文件体积</li> <li>预渲染，打包时进行预渲染</li> <li>使用<code>SSR</code>加速首屏的加载(好废物无端资源), 有利于<code>SEO</code>优化。首屏利用服务端渲染，后续采用客户端渲染</li></ul> <h3 id="浏览器的存储"><a href="#浏览器的存储" class="header-anchor">#</a> 浏览器的存储</h3> <ul><li><code>cookie</code>: cookie过期时间内一直有效，内存大小<code>4k</code>左右】同时限制字段个数，不适合大量的数据存储 ，每次请求都会携带cookie,主要是可以利用做身份检查</li></ul> <blockquote><ul><li>设置<code>cookie</code>的有效期</li> <li>根据不同子域划分<code>cookie</code>较少的传输</li> <li>建泰资源域名和<code>cookie</code>域名采用不同的域名， 避免静态资源的访问时候携带<code>cookie</code></li></ul></blockquote> <ul><li><code>localStorage</code>: chrome下最大存储<code>5M</code>,除非手动清除，否则就一直存在。利用<code>localStorage</code>存储静态资源</li> <li><code>sessionStorage</code>: 会话级别的存储，可用于页面之间的传值</li> <li><code>indexDB</code>: 浏览器的本地数据库(基本无上限)</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/vue-interview/assets/js/app.b2d42ce3.js" defer></script><script src="/vue-interview/assets/js/2.7e7d8ebc.js" defer></script><script src="/vue-interview/assets/js/15.daff4719.js" defer></script>
  </body>
</html>
